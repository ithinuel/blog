<div class="tree-posts">
{% if page.series %}
  <h3>In the series "{{ page.series }}"</h3>
  {% assign count = '0' %}
  {% assign idx = '0' %}
  {% for post in site.posts reversed %}
    {% if post.series == page.series %}
      {% capture count %}{{ count | plus: '1' }}{% endcapture %}
  <article role="article" class="post-item" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
    <div class="content">
      <div class="date">{{ post.date | date_to_string }}</div>
      <a href="{{ post.url | prepend: site.baseurl }}">
        <h2 class="post-title" itemprop="name">
        {% if page.url == post.url %}
          This article
        {% else %}
          Part {{ count }} - {{ post.title }}
        {% endif %}
        </h2>
      </a>
    </div>
  </article>
    {% endif %}
  {% endfor %}
{% endif %}

  <h3>Most recent entries</h3>
  {% for post in site.posts %}
  <article role="article" class="post-item" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
    <div class="content">
      <div class="date">{{ post.date | date_to_string }}</div>
      <a href="{{ post.url | prepend: site.baseurl }}">
        <h2 class="post-title" itemprop="name">{{ post.title }}</h2>
      </a>
    </div>
  </article>
  {% endfor %}
</div>
